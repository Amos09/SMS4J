---
# 这是文章的标题
title: 🫓数据库配置
# 这是页面的图标
icon: <svg t="1679837826543" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1201" width="200" height="200"><path d="M763.136 958.72H262.656c-50.944 0-92.16-41.216-92.16-92.16V518.144H107.776c-25.6 0-48.128-15.36-57.6-39.168s-3.584-50.432 14.848-68.096c0.256-0.256 0.512-0.512 0.768-0.512l344.064-307.2c56.576-53.248 145.408-53.76 202.496-1.28l346.624 307.2 0.512 0.512c18.944 17.408 25.088 44.288 15.616 68.352-9.472 24.064-32 39.424-57.856 39.424h-61.696v348.928c-0.256 50.944-41.472 92.416-92.416 92.416zM107.52 456.704h93.696c16.896 0 30.72 13.824 30.72 30.72v379.136c0 16.896 13.824 30.72 30.72 30.72h500.48c16.896 0 30.72-13.824 30.72-30.72V486.656c0-16.896 13.824-30.72 30.72-30.72H917.504s0.256-0.512 0.256-0.768l-0.256-0.256-346.368-307.2-0.512-0.512c-33.536-30.976-86.016-30.72-119.04 0.768-0.256 0.256-0.512 0.512-0.768 0.512L107.264 455.68c0 0.256-0.256 0.256-0.256 0.256s0.256 0.512 0.512 0.768c-0.256 0 0 0 0 0z m0 0z" fill="#040000" p-id="1202"></path><path d="M644.608 897.024h-61.44v-218.112c0-16.64-13.824-29.952-30.72-29.952H471.04c-16.896 0-30.72 13.568-30.72 29.952v218.112h-61.44v-218.112c0-50.432 41.216-91.392 92.16-91.392h81.408c50.944 0 92.16 40.96 92.16 91.392v218.112z" fill="#D63123" p-id="1203"></path></svg>
# 这是侧边栏的顺序
order: 1
# 设置作者
author: wind
# 设置写作时间
date: 2023-04-12
# 此页面会在文章列表置顶
sticky: true
# 此页面会出现在文章收藏中
star: true
# 你可以自定义页脚
footer: © 2022 wind <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">冀ICP备2021004949号-3</a>
# 你可以自定义版权信息
# copyright: 无版权
---
## 数据库配置
自2.0.0版本开始，sms4j支持数据库配置，如果你要使用数据库配置首先你要在基础的配置文件中
设置数据源和关键字段名称，这次的支持中我们采用的是数据库存储json字符串的形式进行的，并不严格要求
表结构，只需要告诉框架他所要查询的字段即可

配置如下：
```yaml
sms:
  # 告诉框架要读取的厂商配置来源，此处为枚举形式
  config-type: sql_config
  sql:
    # JDBC驱动
    driver-class-name: com.mysql.cj.jdbc.Driver
    # 要链接的数据库名称
    database-name: dev
    # 连接字符串
    url: jdbc:mysql://localhost:3306
    # 数据库账号
    username: root
    # 数据库密码
    password: 123456
    # 配置所在表名
    table-name: config_info
    # 厂商名称存储字段
    supplier-field-name: user_name
    # 配置所在字段
    config-name: pay_psw
    # 配置启用标识字段
    start-name: state
    # 配置启用值  此处意思为 当字段state值为1时，则启用这个配置
    is-start: 1
```
:::tip
在数据库中，可以同时存储多行，每行为一个对应的配置，然后通过启用标识字段来决定是否使用他
可以同时启用多个配置，但是统一厂商只能同时启动一个配置，否则会发生配置覆盖
:::

## 厂商名称枚举
数据库配置模式下 `supplier-field-name`字段所读取的值以以下枚举的中文值为标砖，我们为这个枚举添加了`getName()`方法，你可以通过此方法来获取到枚举的中文部分
```java
public enum SupplierType {
    /** 阿里云*/
    ALIBABA("阿里云短信"),
    /** 华为云*/
    HUAWEI("华为云短信"),
    /** 云片*/
    YUNPIAN("云片短信"),
    /** 腾讯云*/
    TENCENT("腾讯云短信"),
    /** 合一短信*/
    UNI_SMS("合一短信"),
    /** 京东云 */
    JD_CLOUD("京东云短信"),
    /** 容联云 */
    CLOOPEN("容联云短信"),
    /** 亿美软通 */
    EMAY("亿美软通"),
    ;
}
```
## 配置文件类型枚举
目前版本中支持的配置来源类型为`CONFIG_FILE`配置文件类型和`SQL_CONFIG`数据库类型
```java
public enum ConfigType {
    /** 配置文件*/
    CONFIG_FILE("configFile"),

    /** setting配置文件*/
    SETTINGS_FILE("settingsFile"),

    /** 数据库配置*/
    SQL_CONFIG("sqlConfig"),

    /** nacos配置*/
    NACOS_CONFIG("nacosConfig");
}
```
